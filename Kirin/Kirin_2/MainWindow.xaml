<Window x:Class="Kirin_2.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:notification="http://schemas.syncfusion.com/wpf"
        xmlns:settings="clr-namespace:Kirin_2.Properties"
        Background="WhiteSmoke"
        Icon="pack://application:,,,/Images/favicon.ico"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="10"
        TextOptions.TextFormattingMode="Ideal"
        TextOptions.TextRenderingMode="Auto"
        FontFamily="{DynamicResource MaterialDesignFont}"
        mc:Ignorable="d"
        Title="" 
        Width="{x:Static SystemParameters.PrimaryScreenWidth}"
        Height="{x:Static SystemParameters.PrimaryScreenHeight}"
        MinHeight="630" MinWidth="1250" 
        Loaded="Window_Loaded"
        StateChanged="Window_StateChanged"
        WindowStartupLocation="CenterScreen"
        SizeChanged="Window_SizeChanged"
        PreviewMouseWheel="MouseWheelHandler">

    <Window.Resources>
        <SolidColorBrush x:Key="GlyphBrush" Color="#444" />
        <Style x:Key="VerticalSeparatorStyle" TargetType="{x:Type Separator}"
            BasedOn="{StaticResource {x:Type Separator}}">
            <Setter Property="Width" Value="35"/>
            <Setter Property="Background" Value="LightSlateGray"/>
            <Setter Property="Margin" Value="6,0,6,0"/>
            <Setter Property="LayoutTransform">
                <Setter.Value>
                    <TransformGroup>
                        <TransformGroup.Children>
                            <TransformCollection>
                                <RotateTransform Angle="90"/>
                            </TransformCollection>
                        </TransformGroup.Children>
                    </TransformGroup>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ExpandCollapseToggleStyle" TargetType="ToggleButton">
            <Setter Property="Focusable" Value="False"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Grid Width="15" Height="13" Background="Transparent" >
                            <materialDesign:PackIcon Kind="ChevronUp" x:Name="ExpandPath" HorizontalAlignment="Right" 
                                VerticalAlignment="Center" Margin="1,1,1,1" />
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter Property="Kind" TargetName="ExpandPath" Value="ChevronDown"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="TreeViewItemFocusVisual">
            <Setter Property="Control.Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Border>
                            <Rectangle Margin="0,0,5,0" StrokeThickness="5" Stroke="Black"
                                StrokeDashArray="1 2" Opacity="0" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="TreeViewItem">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TreeViewItem}">
                        <StackPanel Margin="-10 0 0 0" >
                            <Separator Background="LightGray" Grid.Row="0" Grid.Column="0" Width="350" Margin="5 5 5 5" x:Name="TreeViewItemSeparator" Visibility="Collapsed"/>
                            <Border x:Name="Bd" Grid.ColumnSpan="2" BorderThickness="1" Padding="{TemplateBinding Padding}" 
                                    SnapsToDevicePixels="true" Height="30" Margin="0 0 0 0">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="true">
                                            </Trigger>
                                            <Trigger Property="IsMouseOver" Value="false">
                                                <Setter Property="Background" Value="Transparent"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <DockPanel>
                                    <Grid DockPanel.Dock="Left">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="330*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="*" />
                                            <RowDefinition Height="30*" />
                                        </Grid.RowDefinitions>

                                        <ContentPresenter x:Name="PART_Header" ContentSource="Header" Grid.Column="0" Grid.ColumnSpan="3" Grid.RowSpan="2" Grid.Row="1" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                                      VerticalAlignment="Center" 
                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" Margin="10 -3 0 0" TextBlock.Foreground="{Binding Source={x:Static settings:Settings.Default}, Path=SPanelItemForeground, Mode=TwoWay }" TextBlock.FontSize="20" TextBlock.FontWeight="ExtraBold" >
                                        </ContentPresenter>
                                    </Grid>
                                    <ToggleButton DockPanel.Dock="Right" x:Name="Expander" VerticalContentAlignment="Top" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0 0 15 0" Grid.Column="1" Grid.Row="0"  Style="{StaticResource ExpandCollapseToggleStyle}" ClickMode="Press" IsChecked="{Binding IsExpanded, RelativeSource={RelativeSource TemplatedParent}}" />
                                </DockPanel>
                            </Border>

                            <ItemsPresenter x:Name="ItemsHost" Grid.ColumnSpan="2" Grid.Column="0" Grid.Row="1">
                            </ItemsPresenter>
                        </StackPanel>
                        <ControlTemplate.Triggers>
                            <Trigger Property="HasItems" Value="true">
                                <Setter TargetName="PART_Header"
                                    Property="TextElement.Foreground"
                                    Value="black"/>
                            </Trigger>
                            <Trigger Property="IsExpanded" Value="false">
                                <Setter Property="Visibility" TargetName="ItemsHost" Value="Collapsed"/>
                            </Trigger>
                            <Trigger Property="HasItems" Value="false">
                                <Setter Property="Visibility" TargetName="Expander" Value="Hidden"/>
                            </Trigger>

                            <Trigger Property="HasItems" Value="True">
                                <Setter Property="Visibility" TargetName="TreeViewItemSeparator" Value="Visible"/>
                            </Trigger>

                            <Trigger Property="IsSelected" Value="true">
                                <Setter Property="Background" TargetName="Bd" Value="#F1F2F3"/>
                                <Setter Property="BorderBrush" TargetName="Bd" Value="transparent"/>
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsSelected" Value="true"/>
                                </MultiTrigger.Conditions>
                                <Setter Property="Background" TargetName="Bd" Value="#F1F2F3"/>
                                <Setter Property="Foreground" Value="#247BC0" />
                                <Setter Property="CornerRadius" TargetName="Bd" Value="0, 20,20, 0" />
                            </MultiTrigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition SourceName="Bd" Property="IsMouseOver" Value="true"/>
                                </MultiTrigger.Conditions>
                                <Setter Property="Cursor" Value="Hand" />
                                <Setter Property="Background" TargetName="Bd" Value="#F1F2F3"/>
                                <Setter Property="CornerRadius" TargetName="Bd" Value="0, 20,20, 0" />
                                <Setter Property="Foreground" Value="#247BC0" />
                            </MultiTrigger>

                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver" Value="true"/>
                                </MultiTrigger.Conditions>

                                <Setter Property="CornerRadius" TargetName="Bd" Value="0, 20,20, 0" />
                                <Setter Property="Foreground" Value="Black" />
                            </MultiTrigger>

                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrush}}"/>
                            </Trigger>

                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="true"/>
                                    <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsMouseOver}" Value="true"/>
                                    <Condition Binding="{Binding ElementName=ItemsHost, Path=IsMouseOver}" Value="True"/>
                                </MultiDataTrigger.Conditions>
                                <Setter Property="Background" TargetName="Bd" Value="transparent" />
                            </MultiDataTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>

            <Setter Property="Margin" Value="10 0 0 0" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="IsExpanded" Value="True" />
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FocusVisualStyle" Value="{StaticResource TreeViewItemFocusVisual}"/>
            <Setter Property="Padding" Value="1,0,0,0"/>
        </Style>

        <Style x:Key="FBButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Margin" Value="0 30 0 20" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="HorizontalContentAlignment" Value="Center" />
            <Setter Property="HorizontalAlignment" Value="Center" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid Background="{TemplateBinding Background}">
                            <ContentPresenter />
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="Transparent"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="{x:Type Button}" x:Key="ButtonStyle">
            <Setter Property="Background" Value="AliceBlue"/>
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border Background="{TemplateBinding Background}" BorderBrush="Transparent" BorderThickness="0" CornerRadius="5">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#247BC0"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <!--<Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#247BC0"/>
                </Trigger>
            </Style.Triggers>-->
        </Style>

        <Storyboard x:Key="OpenMenu">
            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(FrameworkElement.Width)" Storyboard.TargetName="tab_pnl">
                <!--<EasingDoubleKeyFrame KeyTime="0" Value="45"/>-->
                <EasingDoubleKeyFrame KeyTime="0:0:0.3" Value="220"/>
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>

        <Storyboard x:Key="CloseMenu" >
            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(FrameworkElement.Width)" Storyboard.TargetName="tab_pnl">
                <!--<EasingDoubleKeyFrame KeyTime="0" Value="200"/>-->
                <EasingDoubleKeyFrame KeyTime="0:0:0.2" Value="50"/>
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>

        <Storyboard x:Key="OpenMenuSSPnl" CurrentStateInvalidated="Storyboard_OpenMenuSSPnl_CurrentStateInvalidated">
            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(Grid.Width)" Storyboard.TargetName="subsection_pnl">
                <!--<EasingDoubleKeyFrame KeyTime="0" Value="30"/>-->
                <EasingDoubleKeyFrame KeyTime="0:0:0.3" Value="280"/>
            </DoubleAnimationUsingKeyFrames>
            <ColorAnimation 
                  Storyboard.TargetName="animatedPanelColor"
                  Storyboard.TargetProperty="Color"
                  From="Transparent" To="{Binding Source={x:Static settings:Settings.Default}, Path=Subsection_BG, Mode=TwoWay }" Duration="0:0:0.5" />
        </Storyboard>

        <Storyboard x:Key="OpenMenuSSPnl_nonFlick" CurrentStateInvalidated="Storyboard_OpenMenuSSPnl_CurrentStateInvalidated">
            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(Grid.Width)" Storyboard.TargetName="subsection_pnl">
                <!--<EasingDoubleKeyFrame KeyTime="0" Value="30"/>-->
                <EasingDoubleKeyFrame KeyTime="0:0:0.0" Value="280"/>
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>

        <Storyboard x:Key="CloseMenuSSPnl" CurrentStateInvalidated="Storyboard_CloseMenuSSPnl_CurrentStateInvalidated">
            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(Grid.Width)" Storyboard.TargetName="subsection_pnl">
                <!--<EasingDoubleKeyFrame KeyTime="0" Value="188"/>-->
                <EasingDoubleKeyFrame KeyTime="0:0:0.2" Value="15"/>
            </DoubleAnimationUsingKeyFrames>
            <ColorAnimation 
                  Storyboard.TargetName="animatedPanelColor"
                  Storyboard.TargetProperty="Color"
                  From="{Binding Source={x:Static settings:Settings.Default}, Path=Subsection_BG, Mode=TwoWay }" To="Transparent" Duration="0:0:1" />
        </Storyboard>

        <!--// Toggle Button Style Template //-->
        <ImageBrush x:Key="tb_mouse_over"/>

        <!--// Text font style //-->
        <Style x:Key="font_style" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Fonts/Roboto-Light.ttf #Roboto"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="10"/>
        </Style>

        <!--// Tooltip Style Template //-->
        <Style TargetType="ToolTip" x:Key="tt_style">
            <Setter Property="Placement" Value="Bottom"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="Width" Value="110"/>
            <Setter Property="Margin" Value="0,0,0,0"/>
            <Setter Property="Background" Value="#CC374652"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="ToolTipService.HorizontalOffset" Value="50" />
            <Setter Property="ToolTipService.VerticalOffset" Value="-10" />
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontFamily" Value="Fonts/Roboto-Light.ttf #Roboto"/>
            <Setter Property="FontSize" Value="9"/>
            <!--<Setter Property="PlacementRectangle" Value="240,0,0,0"/>-->
            <!--<Setter Property="HorizontalOffset" Value="20"/>
            <Setter Property="VerticalOffset" Value="1"/>-->
            <Setter Property="HasDropShadow" Value="True"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
        </Style>

        <Style TargetType="Label" x:Key="mouseOverStyle">
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Foreground" Value="#247BC0"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="materialDesign:PackIcon" x:Key="mouseOverIcon">
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Foreground" Value="#247BC0"/>
                </Trigger>
            </Style.Triggers>
            <Setter Property="Foreground" Value="SlateGray"/>
        </Style>

        <Style TargetType="{x:Type TextBlock}" x:Key="txtDatagrid">
            <!--<Style TargetType="{x:Type Border}">
                    <Setter Property="CornerRadius" Value="5" />
                </Style>-->
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#247BC0"/>
                    <Setter Property="Foreground" Value="White" />
                </Trigger>
            </Style.Triggers>
            <Setter Property="Background" Value="AliceBlue"/>
            <Setter Property="Foreground" Value="Black" />
        </Style>
    </Window.Resources>
    <Window.Triggers>
        <EventTrigger RoutedEvent="StackPanel.MouseEnter" SourceName="tab_pnl">
            <BeginStoryboard Storyboard="{StaticResource OpenMenu}" Name="sbTabPnl"/>
        </EventTrigger>
        <EventTrigger RoutedEvent="Page.Unloaded" >
            <EventTrigger.Actions>
                <RemoveStoryboard BeginStoryboardName="sbTabPnl" />
            </EventTrigger.Actions>
        </EventTrigger>
        
        <EventTrigger RoutedEvent="StackPanel.MouseLeave" SourceName="tab_pnl">
            <BeginStoryboard Storyboard="{StaticResource CloseMenu}" Name="sbTabPnlMl"/>
        </EventTrigger>
        <EventTrigger RoutedEvent="Page.Unloaded" >
            <EventTrigger.Actions>
                <RemoveStoryboard BeginStoryboardName="sbTabPnlMl" />
            </EventTrigger.Actions>
        </EventTrigger>
        
        <EventTrigger RoutedEvent="ButtonBase.Click" SourceName="subsection_flyoutbtn">
            <BeginStoryboard Storyboard="{StaticResource OpenMenuSSPnl}" Name="sbFlyoutbtn"/>
        </EventTrigger>
        <EventTrigger RoutedEvent="Page.Unloaded" >
            <EventTrigger.Actions>
                <RemoveStoryboard BeginStoryboardName="sbFlyoutbtn" />
            </EventTrigger.Actions>
        </EventTrigger>

        <EventTrigger RoutedEvent="ButtonBase.Click" SourceName="subsection_flyinbtn">
            <BeginStoryboard Storyboard="{StaticResource CloseMenuSSPnl}" Name="sbFlyinbtn"/>
        </EventTrigger>
        <EventTrigger RoutedEvent="Page.Unloaded" >
            <EventTrigger.Actions>
                <RemoveStoryboard BeginStoryboardName="sbFlyinbtn" />
            </EventTrigger.Actions>
        </EventTrigger>

    </Window.Triggers>

    <Grid x:Name="MainWindowGrid" Background="#F8F9FA">
        <Border CornerRadius="10" BorderThickness="1" BorderBrush="Gray">
            <Grid x:Name="MainGrid">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="60"></ColumnDefinition>
                    <ColumnDefinition Width="300*"></ColumnDefinition>
                    <ColumnDefinition x:Name="FrameCol" Width="917*"></ColumnDefinition>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="53*" Name="rowToHide"></RowDefinition>
                    <RowDefinition Height="60*"></RowDefinition>
                    <RowDefinition Height="416*"/>
                    <RowDefinition Height="41*"></RowDefinition>
                </Grid.RowDefinitions>

                <!--region header-->

                <!--<Viewbox Stretch="UniformToFill" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2">-->

                <!--<StackPanel x:Name="MainWindowHeader" Orientation="Horizontal" Background="#f0f4f7"  Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2">-->

                <Grid x:Name="MainWindowHeader" Background="#f0f4f7" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="50*" />
                        <ColumnDefinition Width="30*" />
                        <ColumnDefinition Width="180*" />
                        <ColumnDefinition Width="350*" />
                        <ColumnDefinition Width="130*" />
                        <ColumnDefinition Width="300*" />
                    </Grid.ColumnDefinitions>
                    <GridSplitter Grid.Row="1" Grid.ColumnSpan="6" Height="2" BorderBrush="LightSlateGray" BorderThickness="2" Opacity="1" HorizontalAlignment="Stretch" VerticalAlignment="Bottom"/>
                    <Image Source="/Images/Logo.png" Stretch="Uniform" Margin="5,5,5,5" Grid.Row="0" Grid.Column="0" Cursor="Hand" MouseDown="btnImage_Click" />

                    <!--MouseLeftButtonDown="Image_MouseLeftButtonDown"-->
                    <Viewbox Stretch="Uniform" Grid.Column="1" Grid.Row="0">
                        <Separator Style="{DynamicResource VerticalSeparatorStyle}" Grid.Column="1" Grid.Row="0" Margin="10 0" />
                    </Viewbox>

                    <Viewbox Stretch="Uniform" Grid.Column="2" Grid.Row="0" HorizontalAlignment="Left" VerticalAlignment="Center" Cursor="Hand">
                        <StackPanel HorizontalAlignment="Left" Grid.Column="2" Orientation="Vertical" Margin="0 5 0 5">
                            <Button HorizontalAlignment="Left" HorizontalContentAlignment="Left" Background="WhiteSmoke" BorderThickness="0" Click="Button_Click" Style="{StaticResource Null}">
                                <StackPanel>
                                    <Label x:Name="MainClassSelector" Content="{Binding subjectCode,UpdateSourceTrigger=PropertyChanged}" HorizontalAlignment="Center" FontSize="20" VerticalAlignment="Top" />
                                    <Label Content="{Binding userNameRole,UpdateSourceTrigger=PropertyChanged}" HorizontalAlignment="left" VerticalAlignment="Top" FontSize="14" Margin="0 0 0 5" FontWeight="DemiBold" Foreground="#DD8B8888"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Viewbox>

                    <StackPanel Grid.Column="3" VerticalAlignment="Center">
                        <Viewbox>
                            <ToggleButton Name="btntoggle" Width="430" Cursor="Hand" Click="btntoggle_Click">
                                <ToggleButton.Template>
                                    <ControlTemplate TargetType="ToggleButton" x:Name="ToggleTemplate">
                                        <materialDesign:ColorZone CornerRadius="5" VerticalAlignment="Center" HorizontalAlignment="Left" HorizontalContentAlignment="Left" Mode="Standard" 
                                                                  materialDesign:ShadowAssist.ShadowDepth="Depth1" Height="32" Width="400" Background="#E8EAED" Margin="30 0 0 0 ">
                                            <StackPanel Width="300" VerticalAlignment="Center" HorizontalAlignment="Right" Orientation="Horizontal">
                                                <Button Style="{DynamicResource MaterialDesignToolButton}" Visibility="Visible" Name="matSearch" >
                                                    <materialDesign:PackIcon Margin="5 0 0 0" Kind="Search" Opacity=".56" VerticalAlignment="Center"/>
                                                </Button>
                                                <Border CornerRadius="5" VerticalAlignment="Center" BorderBrush="AliceBlue" BorderThickness="1" Background="AliceBlue" 
                                                        Visibility="Collapsed" x:Name="spSearchFilter" Margin="5 0 0 0">
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Name="txtfilter" TextAlignment="Left" VerticalAlignment="Center" FontSize="10"
                                                                                       FontWeight="Medium" Padding="3 0 3 0"/>
                                                        <Button Name="btnClose" Style="{StaticResource MaterialDesignIconButton}" Height="20" Width="20" FocusVisualStyle="{x:Null}" 
                                                                                       CommandParameter="{Binding Path=ID}" Focusable="False" Click="btnClose_Click">
                                                            <materialDesign:PackIcon Kind="Close" Foreground="Black" Height="15" Width="15" />
                                                        </Button>
                                                    </StackPanel>
                                                </Border>

                                                <TextBox Name="GlobalSearchbox" Width="350" Margin="8 0 0 0" Focusable="True"
                                                         materialDesign:TextFieldAssist.DecorationVisibility="Hidden" BorderThickness="0" Cursor="Hand"
                                                         MinWidth="100" VerticalAlignment="Center" TextChanged="GlobalSearchbox_TextChanged" />
                                            </StackPanel>
                                        </materialDesign:ColorZone>
                                    </ControlTemplate>
                                </ToggleButton.Template>
                            </ToggleButton>
                        </Viewbox>
                        <Popup x:Name="SearchPopup" StaysOpen="False" AllowsTransparency="True" PopupAnimation="Fade">
                            <!--MouseLeave="SearchPopup_MouseLeave"-->
                            <!--IsOpen="{Binding IsChecked, ElementName=btntoggle}"-->
                            <Border BorderThickness="1" CornerRadius="5,5,5,5" BorderBrush="LightGray" Background="White" Width="475">
                                <StackPanel Orientation="Vertical">
                                    <Grid Visibility="Visible" Name="gdBasic">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="40*"/>
                                            <RowDefinition Height="50*"/>
                                            <RowDefinition Height="20*"/>
                                            <RowDefinition Height="50*"/>
                                            <RowDefinition Height="100*"/>
                                            <RowDefinition Height="50*"/>
                                        </Grid.RowDefinitions>
                                        <Button Grid.Row="0" Height="45" Background="Transparent" Cursor="Hand" HorizontalAlignment="Left" BorderThickness="0">
                                            <materialDesign:PackIcon Kind="TextSearch" Foreground="Black" Height="30" Width="30" />
                                        </Button>
                                        <TextBox IsReadOnly="True" BorderThickness="0" Grid.Row="0" Margin="55 0 0 0" Text="Find in Kirin" FontWeight="Medium" FontSize="14" VerticalAlignment="Center"></TextBox>
                                        <TextBox IsReadOnly="True" BorderThickness="0" Margin="18 0 0 6" FontSize="12" Grid.Row="1" Text="I'm looking for..." Foreground="Gray"></TextBox>
                                        <Button Grid.Row="2" Margin="18 0 0 0" FontSize="14" Cursor="Hand" Focusable="False" Content="Students" HorizontalAlignment="Left" 
                                                FontWeight="Medium" Height="30" Width="110" Style="{StaticResource ButtonStyle}" Click="Students_Click" />

                                        <Button Grid.Row="2" Margin="150 0 0 0" FontSize="14" Cursor="Hand" Focusable="False" Content="Staff" HorizontalAlignment="Left" 
                                                FontWeight="Medium" Height="30" Width="100" Style="{StaticResource ButtonStyle}" Click="Staff_Click" />

                                        <Button Grid.Row="2" Margin="274 0 0 0" FontSize="14" Cursor="Hand" Focusable="False" Content="Assignment" HorizontalAlignment="Left" 
                                                FontWeight="Medium" Height="30" Width="110" Style="{StaticResource ButtonStyle}" Click="Assignment_Click" />

                                        <TextBox IsReadOnly="True" BorderThickness="0" FontSize="12" Margin="18 7 0 8" Grid.Row="3" Text="Recent searches" Foreground="Gray"></TextBox>

                                        <DataGrid Grid.Row="4" x:Name="DGSearches" Height="Auto" Background="Transparent" HeadersVisibility="None" Margin="0 0 0 6" 
                                                  ItemsSource="{Binding ResentSearchList}" AutoGenerateColumns="False" Focusable="False" GridLinesVisibility="None"
                                                  CanUserAddRows="False" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Auto">
                                            <DataGrid.CellStyle>
                                                <Style TargetType="DataGridCell">
                                                    <Setter Property="Height" Value="34"/>
                                                    <Setter Property="Focusable" Value="False"/>
                                                    <Setter Property="Background" Value="Transparent" />
                                                    <Setter Property="Foreground" Value="Black" />
                                                    <Setter Property="Cursor" Value="Hand" />
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="#247BC0" />
                                                            <Setter Property="Foreground" Value="White" />
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGrid.CellStyle>
                                            <DataGrid.Columns>
                                                <DataGridTemplateColumn>
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Width="550">
                                                                <Grid Grid.Row="0" Grid.Column="0" Margin="18 0 8 0">
                                                                    <materialDesign:PackIcon Grid.Row="4" Kind="ClockOutline" Height="30" Width="30" />
                                                                </Grid>
                                                                <Grid Grid.Row="0" Grid.Column="1" VerticalAlignment="Center" Height="30">
                                                                    <TextBlock Text="{Binding Path=Keyword}" TextAlignment="Left" VerticalAlignment="Center" FontSize="14" FontWeight="Medium" />
                                                                </Grid>
                                                            </StackPanel>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>

                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Grid.Row="5" Background="#F5F5F5" Height="35">
                                            <Grid Grid.Row="0" Grid.Column="0">
                                                <TextBox IsReadOnly="True" BorderThickness="0" FontSize="12" VerticalAlignment="Center" HorizontalContentAlignment="Right" Width="300" Text="Not the resuts you expected?" Foreground="Gray"></TextBox>
                                            </Grid>
                                            <Grid Grid.Row="0" Grid.Column="1">
                                                <TextBlock VerticalAlignment="Center" FontSize="12">           
                                                    <Hyperlink RequestNavigate="Hyperlink_RequestNavigate" NavigateUri="pack://application:,,,/Pages/FeedbackWindow.xaml">
                                                        Give feedback
                                                    </Hyperlink>
                                                </TextBlock>
                                            </Grid>
                                            <Grid Grid.Row="0" Grid.Column="2">
                                                <TextBox Text="or" FontSize="12" VerticalAlignment="Center" IsReadOnly="True" BorderThickness="0" Margin="3 0 3 0"></TextBox>
                                            </Grid>
                                            <Grid Grid.Row="0" Grid.Column="3">
                                                <TextBlock VerticalAlignment="Center" FontSize="12">           
                                                    <Hyperlink RequestNavigate="Learn_RequestNavigate">
                                                       learn more
                                                    </Hyperlink>
                                                </TextBlock>
                                            </Grid>
                                        </StackPanel>
                                    </Grid>

                                    <Grid Visibility="Collapsed" Name="gdGlobal">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="210"/>
                                            <RowDefinition Height="50*"/>
                                        </Grid.RowDefinitions>
                                        <DataGrid Grid.Row="0" x:Name="DGGlobalSearch" Height="Auto" Background="Transparent" HeadersVisibility="None" Margin="0 0 0 6" 
                                                  ItemsSource="{Binding GlobalSearchList}" AutoGenerateColumns="False" Focusable="False" GridLinesVisibility="None"
                                                  CanUserAddRows="False" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Disabled"
                                                  SelectionChanged="DGGlobalSearch_SelectionChanged" ScrollViewer.CanContentScroll="False" >
                                            <DataGrid.CellStyle>
                                                <Style TargetType="DataGridCell">
                                                    <Setter Property="Height" Value="40"/>
                                                    <Setter Property="Focusable" Value="False"/>
                                                    <Setter Property="Background" Value="Transparent" />
                                                    <Setter Property="Foreground" Value="Black" />
                                                    <Setter Property="Cursor" Value="Hand" />
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="#247BC0" />
                                                            <Setter Property="Foreground" Value="White" />
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGrid.CellStyle>
                                            <DataGrid.Columns>
                                                <DataGridTemplateColumn>
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Width="550" Grid.Row="3">
                                                                <Grid Grid.Row="0" Grid.Column="0" Margin="18 4 8 0">
                                                                    <materialDesign:PackIcon Kind="Person" Background="AliceBlue" Foreground="Black" Height="30" Width="30" />
                                                                </Grid>
                                                                <Grid Grid.Row="0" Grid.Column="1" VerticalAlignment="Center" Height="37">
                                                                    <TextBlock Text="{Binding Path=Name}" TextAlignment="Left" VerticalAlignment="Center" FontSize="14" FontWeight="Medium" ></TextBlock>
                                                                    <TextBlock Text="{Binding Path=FirstName}" Visibility="Collapsed" ></TextBlock>
                                                                    <TextBlock Text="{Binding Path=LastName}" Visibility="Collapsed" ></TextBlock>
                                                                </Grid>
                                                                <Grid Grid.Row="0" Grid.Column="2" VerticalAlignment="Center" Height="35" Margin="8 0 0 0">
                                                                    <TextBlock Text="{Binding Path=Reference}" TextAlignment="Left" VerticalAlignment="Center" FontSize="12" 
                                                                               FontWeight="Medium" Padding="4" Background="AliceBlue" Foreground="Black">
                                                                    </TextBlock>
                                                                </Grid>
                                                                <Grid Grid.Row="0" Grid.Column="3" VerticalAlignment="Center" Height="35" Margin="8 0 0 0">
                                                                    <TextBlock Text="{Binding Path=Role}" TextAlignment="Left" VerticalAlignment="Center" FontSize="12" 
                                                                               FontWeight="Medium" Padding="4" Background="AliceBlue" Foreground="Black">
                                                                    </TextBlock>
                                                                </Grid>
                                                            </StackPanel>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>

                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Grid.Row="1" Background="#F5F5F5" Height="35">
                                            <Grid Grid.Row="0" Grid.Column="0">
                                                <TextBox IsReadOnly="True" BorderThickness="0" FontSize="12" VerticalAlignment="Center" HorizontalContentAlignment="Right" Width="300" Text="Not the resuts you expected?" Foreground="Gray"></TextBox>
                                            </Grid>
                                            <Grid Grid.Row="0" Grid.Column="1">
                                                <TextBlock VerticalAlignment="Center" FontSize="12">           
                                                    <Hyperlink RequestNavigate="Hyperlink_RequestNavigate" NavigateUri="pack://application:,,,/Pages/FeedbackWindow.xaml">
                                                        Give feedback
                                                    </Hyperlink>
                                                </TextBlock>
                                            </Grid>
                                            <Grid Grid.Row="0" Grid.Column="2">
                                                <TextBox Text="or" FontSize="12" VerticalAlignment="Center" IsReadOnly="True" BorderThickness="0" Margin="3 0 3 0"></TextBox>
                                            </Grid>
                                            <Grid Grid.Row="0" Grid.Column="3">
                                                <TextBlock VerticalAlignment="Center" FontSize="12">           
                                                    <Hyperlink RequestNavigate="Learn_RequestNavigate">
                                                       learn more
                                                    </Hyperlink>
                                                </TextBlock>
                                            </Grid>
                                        </StackPanel>
                                    </Grid>

                                    <Grid Visibility="Collapsed" Name="gdAdvanced">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="30*"/>
                                            <RowDefinition Height="210"/>
                                            <RowDefinition Height="50*"/>
                                        </Grid.RowDefinitions>

                                        <TextBox Name="txtSearchTitle" IsReadOnly="True" BorderThickness="0" FontSize="12" Margin="18 7 0 8" Grid.Row="0" Foreground="Gray"></TextBox>

                                        <DataGrid Grid.Row="1" x:Name="DGSearchList" Height="Auto" Background="Transparent" HeadersVisibility="None" Margin="0 0 0 6" 
                                                  ItemsSource="{Binding AdvancedSearchList}" AutoGenerateColumns="False" Focusable="False" GridLinesVisibility="None"
                                                  CanUserAddRows="False" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Disabled"
                                                  SelectionChanged="DGSearchList_SelectionChanged" ScrollViewer.CanContentScroll="False" Visibility="Collapsed">
                                            <DataGrid.CellStyle>
                                                <Style TargetType="DataGridCell">
                                                    <Setter Property="Height" Value="40"/>
                                                    <Setter Property="Focusable" Value="False"/>
                                                    <Setter Property="Background" Value="Transparent" />
                                                    <Setter Property="Foreground" Value="Black" />
                                                    <Setter Property="Cursor" Value="Hand" />
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="#247BC0" />
                                                            <Setter Property="Foreground" Value="White" />
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGrid.CellStyle>
                                            <DataGrid.Columns>
                                                <DataGridTemplateColumn>
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Width="550" Grid.Row="3">
                                                                <Grid Grid.Row="0" Grid.Column="0" Margin="18 4 8 0">
                                                                    <materialDesign:PackIcon Kind="Person" Background="AliceBlue" Foreground="Black" Height="30" Width="30" />
                                                                </Grid>
                                                                <Grid Grid.Row="0" Grid.Column="1" VerticalAlignment="Center" Height="37">
                                                                    <TextBlock Text="{Binding Path=Name}" TextAlignment="Left" VerticalAlignment="Center" FontSize="14" FontWeight="Medium" ></TextBlock>
                                                                    <TextBlock Text="{Binding Path=FirstName}" Visibility="Collapsed" ></TextBlock>
                                                                    <TextBlock Text="{Binding Path=LastName}" Visibility="Collapsed" ></TextBlock>
                                                                </Grid>
                                                                <Grid Grid.Row="0" Grid.Column="2" VerticalAlignment="Center" Height="35" Margin="8 0 0 0">
                                                                    <TextBlock Text="{Binding Path=Reference}" TextAlignment="Left" VerticalAlignment="Center" FontSize="12" 
                                                                               FontWeight="Medium" Padding="4" Background="AliceBlue" Foreground="Black"> <!--Style="{StaticResource txtDatagrid}"-->
                                                                    </TextBlock>
                                                                </Grid>
                                                                <Grid Grid.Row="0" Grid.Column="3" VerticalAlignment="Center" Height="35" Margin="8 0 0 0">
                                                                    <TextBlock Text="{Binding Path=Role}" TextAlignment="Left" VerticalAlignment="Center" FontSize="12" 
                                                                               FontWeight="Medium" Padding="4" Background="AliceBlue" Foreground="Black">
                                                                    </TextBlock>
                                                                </Grid>
                                                            </StackPanel>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>

                                        <DataGrid Grid.Row="1" x:Name="DGStaffList" Height="Auto" Background="Transparent" HeadersVisibility="None" Margin="0 0 0 6" 
                                                  ItemsSource="{Binding AdvancedSearchStaffList}" AutoGenerateColumns="False" Focusable="False" GridLinesVisibility="None"
                                                  CanUserAddRows="False" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Disabled"
                                                  SelectionChanged="DGStaffList_SelectionChanged" ScrollViewer.CanContentScroll="False" Visibility="Collapsed">
                                            <DataGrid.CellStyle>
                                                <Style TargetType="DataGridCell">
                                                    <Setter Property="Height" Value="40"/>
                                                    <Setter Property="Focusable" Value="False"/>
                                                    <Setter Property="Background" Value="Transparent" />
                                                    <Setter Property="Foreground" Value="Black" />
                                                    <Setter Property="Cursor" Value="Hand" />
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="#247BC0" />
                                                            <Setter Property="Foreground" Value="White" />
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGrid.CellStyle>
                                            <DataGrid.Columns>
                                                <DataGridTemplateColumn>
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Width="550" Grid.Row="3">
                                                                <Grid Grid.Row="0" Grid.Column="0" Margin="18 4 8 0">
                                                                    <materialDesign:PackIcon Kind="Person" Background="AliceBlue" Foreground="Black" Height="30" Width="30" />
                                                                </Grid>
                                                                <Grid Grid.Row="0" Grid.Column="1" VerticalAlignment="Center" Height="37">
                                                                    <TextBlock Text="{Binding Path=Name}" TextAlignment="Left" VerticalAlignment="Center" FontSize="14" FontWeight="Medium" ></TextBlock>
                                                                    <TextBlock Text="{Binding Path=FirstName}" Visibility="Collapsed" ></TextBlock>
                                                                    <TextBlock Text="{Binding Path=LastName}" Visibility="Collapsed" ></TextBlock>
                                                                </Grid>
                                                                <Grid Grid.Row="0" Grid.Column="2" VerticalAlignment="Center" Height="35" Margin="8 0 0 0">
                                                                    <TextBlock Text="{Binding Path=Reference}" TextAlignment="Left" VerticalAlignment="Center" FontSize="12" 
                                                                               FontWeight="Medium" Padding="4" Background="AliceBlue" Foreground="Black"> <!--Style="{StaticResource txtDatagrid}"-->
                                                                    </TextBlock>
                                                                </Grid>
                                                                <Grid Grid.Row="0" Grid.Column="3" VerticalAlignment="Center" Height="35" Margin="8 0 0 0">
                                                                    <TextBlock Text="{Binding Path=Role}" TextAlignment="Left" VerticalAlignment="Center" FontSize="12" 
                                                                               FontWeight="Medium" Padding="4" Background="AliceBlue" Foreground="Black">
                                                                    </TextBlock>
                                                                </Grid>
                                                            </StackPanel>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>

                                        <DataGrid Grid.Row="1" x:Name="DGAssignmentList" Height="Auto" Background="Transparent" HeadersVisibility="None" Margin="0 0 0 6" 
                                                  ItemsSource="{Binding SearchAssignmentList}" AutoGenerateColumns="False" Focusable="False" GridLinesVisibility="None"
                                                  CanUserAddRows="False" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Disabled"
                                                  SelectionChanged="DGAssignmentList_SelectionChanged" ScrollViewer.CanContentScroll="False" Visibility="Collapsed">
                                            <DataGrid.CellStyle>
                                                <Style TargetType="DataGridCell">
                                                    <Setter Property="Height" Value="40"/>
                                                    <Setter Property="Focusable" Value="False"/>
                                                    <Setter Property="Background" Value="Transparent" />
                                                    <Setter Property="Foreground" Value="Black" />
                                                    <Setter Property="Cursor" Value="Hand" />
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="#247BC0" />
                                                            <Setter Property="Foreground" Value="White" />
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGrid.CellStyle>
                                            <DataGrid.Columns>
                                                <DataGridTemplateColumn>
                                                    <DataGridTemplateColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Width="550" Grid.Row="3">
                                                                <Grid Grid.Row="0" Grid.Column="0" Margin="18 4 8 0">
                                                                    <materialDesign:PackIcon Kind="Person" Background="AliceBlue" Foreground="Black" Height="30" Width="30" />
                                                                </Grid>
                                                                <Grid Grid.Row="0" Grid.Column="1" VerticalAlignment="Center" Height="37">
                                                                    <TextBlock Text="{Binding Path=Name}" TextAlignment="Left" VerticalAlignment="Center" FontSize="14" FontWeight="Medium" ></TextBlock>
                                                                </Grid>
                                                                <Grid Grid.Row="0" Grid.Column="2" VerticalAlignment="Center" Height="35" Margin="8 0 0 0">
                                                                    <TextBlock Text="{Binding Path=Reference}" TextAlignment="Left" VerticalAlignment="Center" FontSize="12" 
                                                                               FontWeight="Medium" Padding="4" Background="AliceBlue" Foreground="Black"> <!--Style="{StaticResource txtDatagrid}"-->
                                                                    </TextBlock>
                                                                </Grid>
                                                            </StackPanel>
                                                        </DataTemplate>
                                                    </DataGridTemplateColumn.CellTemplate>
                                                </DataGridTemplateColumn>
                                            </DataGrid.Columns>
                                        </DataGrid>

                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Grid.Row="2" Background="#F5F5F5" Height="35">
                                            <Grid Grid.Row="0" Grid.Column="0">
                                                <TextBox IsReadOnly="True" BorderThickness="0" FontSize="12" VerticalAlignment="Center" HorizontalContentAlignment="Right" Width="300" Text="Not the resuts you expected?" Foreground="Gray"></TextBox>
                                            </Grid>
                                            <Grid Grid.Row="0" Grid.Column="1">
                                                <TextBlock VerticalAlignment="Center" FontSize="12">           
                                                    <Hyperlink RequestNavigate="Hyperlink_RequestNavigate" NavigateUri="pack://application:,,,/Pages/FeedbackWindow.xaml">
                                                        Give feedback
                                                    </Hyperlink>
                                                </TextBlock>
                                            </Grid>
                                            <Grid Grid.Row="0" Grid.Column="2">
                                                <TextBox Text="or" FontSize="12" VerticalAlignment="Center" IsReadOnly="True" BorderThickness="0" Margin="3 0 3 0"></TextBox>
                                            </Grid>
                                            <Grid Grid.Row="0" Grid.Column="3">
                                                <TextBlock VerticalAlignment="Center" FontSize="12">           
                                                    <Hyperlink RequestNavigate="Learn_RequestNavigate">
                                                       learn more
                                                    </Hyperlink>
                                                </TextBlock>
                                            </Grid>
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </Popup>
                    </StackPanel>

                    <!--NAVIGATION LINKS-->
                    <StackPanel Orientation="Horizontal" Grid.Column="4">
                        <Viewbox Stretch="Uniform">
                            <StackPanel Orientation="Horizontal">
                                <Button Style="{StaticResource MaterialDesignIconButton}" Click="BackButton_Click"
                                        ToolTip="Go Back" Margin="20 0 0 0" Background="Transparent"
                                        IsEnabled="{Binding DataContext.ControlsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}">
                                    <materialDesign:PackIcon Kind="ArrowLeftCircle" Foreground="Gray" Height="20"  />
                                </Button>
                                <Button Style="{StaticResource MaterialDesignIconButton}" Click="ForwardButton_Click"
                                        ToolTip="Go Forward" Background="Transparent"
                                        IsEnabled="{Binding DataContext.ControlsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}">
                                    <materialDesign:PackIcon Kind="ArrowRightCircle" Foreground="Gray" Height="20" />
                                </Button>
                            </StackPanel>
                        </Viewbox>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Grid.Column="5">
                        <Viewbox Stretch="Uniform">
                            <StackPanel Orientation="Horizontal">
                                <Button Style="{StaticResource MaterialDesignIconButton}" ToolTip="FAQs" Background="Transparent"
                                      IsEnabled="{Binding DataContext.ControlsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}">
                                    <materialDesign:PackIcon Kind="Viewgrid" Foreground="Gray" Height="15" />
                                </Button>

                                <!--<Button Style="{StaticResource MaterialDesignIconButton}" Click="View_DailyBulletin"
                                      ToolTip="Daily Bulletin" Background="Transparent"
                                      IsEnabled="{Binding DataContext.ControlsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}">
                                    <materialDesign:PackIcon Kind="BellOutline" Foreground="Gray" Height="20" >
                                        <notification:SfBadge.Badge>
                                            <notification:SfBadge Shape="None" HorizontalPosition="0.7" VerticalPosition="0.3" x:Name="badge">
                                                <notification:SfBadge.Content>
                                                    <Ellipse Width="7" Height="7" Fill="Red"/>
                                                </notification:SfBadge.Content>
                                            </notification:SfBadge>
                                        </notification:SfBadge.Badge>
                                    </materialDesign:PackIcon>
                                </Button>-->

                                <Button x:Name="btnNotification" Style="{StaticResource MaterialDesignIconButton}" Background="Transparent"
                                      IsEnabled="{Binding DataContext.ControlsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}">
                                    <Button.Triggers>
                                        <EventTrigger RoutedEvent="Button.Click">
                                            <EventTrigger.Actions>
                                                <BeginStoryboard Name="sbBtnNotification">
                                                    <Storyboard>
                                                        <BooleanAnimationUsingKeyFrames Storyboard.TargetName="NotificationPopup" 
                                                             Storyboard.TargetProperty="IsOpen">
                                                            <DiscreteBooleanKeyFrame KeyTime="0:0:0" Value="True" />
                                                        </BooleanAnimationUsingKeyFrames>
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </EventTrigger.Actions>
                                        </EventTrigger>
                                        <EventTrigger RoutedEvent="Page.Unloaded" >
                                            <EventTrigger.Actions>
                                                <RemoveStoryboard BeginStoryboardName="sbBtnNotification" />
                                            </EventTrigger.Actions>
                                        </EventTrigger>
                                    </Button.Triggers>
                                    <materialDesign:PackIcon Kind="BellOutline" Foreground="Gray" Height="20" >
                                        <notification:SfBadge.Badge>
                                            <notification:SfBadge Shape="None" HorizontalPosition="0.7" VerticalPosition="0.3" x:Name="badge">
                                                <notification:SfBadge.Content>
                                                    <Ellipse Width="7" Height="7" Fill="Red"/>
                                                </notification:SfBadge.Content>
                                            </notification:SfBadge>
                                        </notification:SfBadge.Badge>
                                    </materialDesign:PackIcon>
                                </Button>

                                <Popup x:Name="NotificationPopup" PlacementTarget="{Binding ElementName=btnNotification}" 
                                       StaysOpen="False" AllowsTransparency="True" PopupAnimation="Fade">
                                    <Border Height="300" BorderThickness="1" CornerRadius="5,5,5,5" BorderBrush="LightGray" 
                                        Background="White" Width="240" Name="Close">
                                        <ScrollViewer VerticalScrollBarVisibility="Auto" Visibility="Visible">
                                            <StackPanel Orientation="Vertical">
                                                <Grid Visibility="Visible">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="40*"/>
                                                        <RowDefinition Height="50*"/>
                                                        <RowDefinition Height="20*"/>
                                                        <RowDefinition Height="100*"/>
                                                        <RowDefinition Height="20*"/>
                                                        <RowDefinition Height="100*"/>
                                                    </Grid.RowDefinitions>

                                                    <Label Grid.Row="0" VerticalAlignment="Center" FontSize="11" FontWeight="Bold"
                                                       Margin="10 10 0 10" HorizontalAlignment="Left" Content="Notifications" />

                                                    <DataGrid Grid.Row="1" Width="220" x:Name="DGSchoolAlert" Height="Auto" Background="Transparent" HeadersVisibility="None"
                                                      ItemsSource="{Binding SchoolAlertsList}" AutoGenerateColumns="False" Focusable="False" GridLinesVisibility="None"
                                                      CanUserAddRows="False" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Auto" Cursor="Hand">
                                                        <DataGrid.CellStyle>
                                                            <Style TargetType="DataGridCell">
                                                                <Setter Property="Height" Value="50"/>
                                                                <Setter Property="Focusable" Value="False"/>
                                                                <Setter Property="Background" Value="#E9F1F8" />
                                                                <Style.Triggers>
                                                                    <Trigger Property="IsMouseOver" Value="True">
                                                                        <Setter Property="Background" Value="#c2d8ec" />
                                                                    </Trigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </DataGrid.CellStyle>
                                                        <DataGrid.Columns>
                                                            <DataGridTemplateColumn>
                                                                <DataGridTemplateColumn.CellTemplate>
                                                                    <DataTemplate>
                                                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Width="220" Height="50">
                                                                            <Grid Grid.Row="0" Grid.Column="0" Margin="8 0 8 0">
                                                                                <Ellipse Grid.Row="0" Height="25" Width="25" HorizontalAlignment="Left">
                                                                                    <Ellipse.Fill>
                                                                                        <ImageBrush ImageSource="/Images/Logo.png"/>
                                                                                    </Ellipse.Fill>
                                                                                </Ellipse>
                                                                            </Grid>
                                                                            <Grid Grid.Row="0" Grid.Column="1" VerticalAlignment="Center" Height="30" Width="150">
                                                                                <TextBlock Text="{Binding Path=Message}" TextAlignment="Left" VerticalAlignment="Top" FontSize="7"
                                                                                       TextWrapping="Wrap" MaxWidth="145"></TextBlock>
                                                                                <TextBlock Text="{Binding Path=UpdatedDate}" TextAlignment="Left" VerticalAlignment="Bottom" FontSize="6" MaxWidth="145"></TextBlock>
                                                                            </Grid>
                                                                            <Grid Grid.Row="0" Grid.Column="2" VerticalAlignment="Top" >
                                                                                <Button Style="{StaticResource MaterialDesignIconButton}" Height="25" Width="25" FocusVisualStyle="{x:Null}" Focusable="False"
                                                                                    CommandParameter="{Binding Path=ID}" ToolTip="UnPin" Click="UnPin_Click" Visibility="{Binding Path=Visibility}">
                                                                                    <materialDesign:PackIcon Kind="PinOffOutline" Foreground="Black" Height="10" Width="10" />
                                                                                </Button>
                                                                            </Grid>
                                                                        </StackPanel>
                                                                    </DataTemplate>
                                                                </DataGridTemplateColumn.CellTemplate>
                                                            </DataGridTemplateColumn>
                                                        </DataGrid.Columns>
                                                    </DataGrid>

                                                    <Label Grid.Row="2" VerticalAlignment="Center" FontSize="9" FontWeight="Bold" Foreground="LightGray"
                                                       Margin="10 0 0 0" HorizontalAlignment="Left" Content="NEW" />

                                                    <DataGrid Grid.Row="3" Width="220" x:Name="DGNew" Height="Auto" Background="Transparent" HeadersVisibility="None"
                                                      ItemsSource="{Binding NewNotificationList}" AutoGenerateColumns="False" Focusable="False" GridLinesVisibility="None"
                                                      CanUserAddRows="False" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Auto"
                                                      SelectionChanged="DGNew_SelectionChanged" Cursor="Hand">
                                                        <DataGrid.CellStyle>
                                                            <Style TargetType="DataGridCell">
                                                                <Setter Property="Height" Value="50"/>
                                                                <Setter Property="Focusable" Value="False"/>
                                                                <Setter Property="Background" Value="#E9F1F8"/>
                                                                <Style.Triggers>
                                                                    <Trigger Property="IsMouseOver" Value="True">
                                                                        <Setter Property="Background" Value="#c2d8ec" />
                                                                    </Trigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </DataGrid.CellStyle>
                                                        <DataGrid.Columns>
                                                            <DataGridTemplateColumn>
                                                                <DataGridTemplateColumn.CellTemplate>
                                                                    <DataTemplate>
                                                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Width="220" Height="50">
                                                                            <Grid Grid.Row="0" Grid.Column="0" Margin="8 0 8 0">
                                                                                <Ellipse Grid.Row="0" Height="25" Width="25" HorizontalAlignment="Left" >
                                                                                    <Ellipse.Fill>
                                                                                        <ImageBrush ImageSource="/Images/Logo.png"/>
                                                                                    </Ellipse.Fill>
                                                                                </Ellipse>
                                                                            </Grid>
                                                                            <Grid Grid.Row="0" Grid.Column="1" VerticalAlignment="Center" Height="30" Width="140">
                                                                                <TextBlock Text="{Binding Path=DesignedMessage}" TextAlignment="Left" VerticalAlignment="Top" FontSize="7"
                                                                                       TextWrapping="Wrap" MaxWidth="145"></TextBlock>
                                                                                <TextBlock Text="{Binding Path=UpdatedDate}" TextAlignment="Left" VerticalAlignment="Bottom" FontSize="6" MaxWidth="145"></TextBlock>
                                                                            </Grid>
                                                                            <Grid Grid.Row="0" Grid.Column="2" VerticalAlignment="Top" Margin="-5 0 0 0">
                                                                                <Button Name="btnNew" Style="{StaticResource MaterialDesignIconButton}" Height="25" Width="25" FocusVisualStyle="{x:Null}" 
                                                                                       CommandParameter="{Binding Path=ID}" Focusable="False" Click="NewClose_Click">
                                                                                    <materialDesign:PackIcon Kind="Close" Foreground="Black" Height="10" Width="10" />
                                                                                </Button>
                                                                            </Grid>
                                                                            <Grid Grid.Row="0" Grid.Column="3" VerticalAlignment="Top" Width="25" Margin="-5 0 0 0">
                                                                                <Button Name="btnNewPin" Style="{StaticResource MaterialDesignIconButton}" Height="25" Width="25" FocusVisualStyle="{x:Null}" 
                                                                                       CommandParameter="{Binding Path=ID}" Focusable="False" Click="btnNewPin_Click">
                                                                                    <materialDesign:PackIcon Kind="PinOutline" Foreground="Black" Height="10" Width="10" />
                                                                                </Button>
                                                                            </Grid>
                                                                        </StackPanel>
                                                                    </DataTemplate>
                                                                </DataGridTemplateColumn.CellTemplate>
                                                            </DataGridTemplateColumn>
                                                        </DataGrid.Columns>
                                                    </DataGrid>

                                                    <Label Grid.Row="4" VerticalAlignment="Center" FontSize="9" FontWeight="Bold" Foreground="LightGray"
                                                       Margin="10 0 0 0" HorizontalAlignment="Left" Content="EARLIER" />

                                                    <DataGrid Grid.Row="5" Width="220" x:Name="DGEarlier" Height="Auto" Background="Transparent" HeadersVisibility="None"
                                                      ItemsSource="{Binding EarlierNotificationList}" AutoGenerateColumns="False" Focusable="False" GridLinesVisibility="None"
                                                      CanUserAddRows="False" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Auto"
                                                      SelectionChanged="DGEarlier_SelectionChanged" Cursor="Hand">
                                                        <DataGrid.CellStyle>
                                                            <Style TargetType="DataGridCell">
                                                                <Setter Property="Height" Value="50"/>
                                                                <Setter Property="Focusable" Value="False"/>
                                                                <Setter Property="Background" Value="#E9F1F8"/>
                                                                <Style.Triggers>
                                                                    <Trigger Property="IsMouseOver" Value="True">
                                                                        <Setter Property="Background" Value="#c2d8ec" />
                                                                    </Trigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </DataGrid.CellStyle>
                                                        <DataGrid.Columns>
                                                            <DataGridTemplateColumn>
                                                                <DataGridTemplateColumn.CellTemplate>
                                                                    <DataTemplate>
                                                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Width="220" Height="50">
                                                                            <Grid Grid.Row="0" Grid.Column="0" Margin="8 0 8 0">
                                                                                <Ellipse Grid.Row="0" Height="25" Width="25" HorizontalAlignment="Left" >
                                                                                    <Ellipse.Fill>
                                                                                        <ImageBrush ImageSource="/Images/Logo.png"/>
                                                                                    </Ellipse.Fill>
                                                                                </Ellipse>
                                                                            </Grid>
                                                                            <Grid Grid.Row="0" Grid.Column="1" VerticalAlignment="Center" Height="30" Width="140">
                                                                                <TextBlock Text="{Binding Path=DesignedMessage}" TextAlignment="Left" VerticalAlignment="Top" FontSize="7"
                                                                                       TextWrapping="Wrap" MaxWidth="145"></TextBlock>
                                                                                <TextBlock Text="{Binding Path=UpdatedDate}" TextAlignment="Left" VerticalAlignment="Bottom" FontSize="6" MaxWidth="145"></TextBlock>
                                                                            </Grid>
                                                                            <Grid Grid.Row="0" Grid.Column="2" VerticalAlignment="Top" Margin="-5 0 0 0">
                                                                                <Button Style="{StaticResource MaterialDesignIconButton}" Height="25" Width="25" FocusVisualStyle="{x:Null}" 
                                                                                        Focusable="False" Click="EarlierClose_Click" CommandParameter="{Binding Path=ID}" >
                                                                                    <materialDesign:PackIcon Kind="Close" Foreground="Black" Height="10" Width="10" />
                                                                                </Button>
                                                                            </Grid>
                                                                            <Grid Grid.Row="0" Grid.Column="3" VerticalAlignment="Top" Width="25" Margin="-5 0 0 0">
                                                                                <Button Name="btnEarlierPin" Style="{StaticResource MaterialDesignIconButton}" Height="25" Width="25" FocusVisualStyle="{x:Null}" 
                                                                                       CommandParameter="{Binding Path=ID}" Focusable="False" Click="btnEarlierPin_Click">
                                                                                    <materialDesign:PackIcon Kind="PinOutline" Foreground="Black" Height="10" Width="10" />
                                                                                </Button>
                                                                            </Grid>
                                                                        </StackPanel>
                                                                    </DataTemplate>
                                                                </DataGridTemplateColumn.CellTemplate>
                                                            </DataGridTemplateColumn>
                                                        </DataGrid.Columns>
                                                    </DataGrid>
                                                </Grid>
                                            </StackPanel>
                                        </ScrollViewer>
                                    </Border>
                                </Popup>

                                <!--<Viewbox Stretch="Uniform">-->
                                <Button Name="btnHelp" Style="{StaticResource MaterialDesignIconButton}" ToolTip="Help" Background="Transparent"
                                    IsEnabled="{Binding DataContext.ControlsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}">
                                    <Button.Triggers>
                                        <EventTrigger RoutedEvent="Button.Click">
                                            <EventTrigger.Actions>
                                                <BeginStoryboard Name="sbBtnHelp">
                                                    <Storyboard>
                                                        <BooleanAnimationUsingKeyFrames Storyboard.TargetName="HelpPopup" 
                                                             Storyboard.TargetProperty="IsOpen">
                                                            <DiscreteBooleanKeyFrame KeyTime="0:0:0" Value="True" />
                                                        </BooleanAnimationUsingKeyFrames>
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </EventTrigger.Actions>
                                        </EventTrigger>
                                        <EventTrigger RoutedEvent="Page.Unloaded" >
                                            <EventTrigger.Actions>
                                                <RemoveStoryboard BeginStoryboardName="sbBtnHelp" />
                                            </EventTrigger.Actions>
                                        </EventTrigger>
                                    </Button.Triggers>
                                    <materialDesign:PackIcon Kind="HelpCircleOutline" Foreground="Gray" Height="20" />
                                </Button>
                                <!--</Viewbox>-->

                                <Popup x:Name="HelpPopup" PlacementTarget="{Binding ElementName=btnHelp}" StaysOpen="False" AllowsTransparency="True" PopupAnimation="Fade">
                                    <Border Height="350" BorderThickness="1" CornerRadius="5,5,5,5" BorderBrush="LightGray" 
                                        Background="White" Width="240">
                                        <StackPanel Orientation="Vertical">
                                            <Grid Visibility="Visible">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="*"/>
                                                    <RowDefinition Height="*"/>
                                                    <RowDefinition Height="*"/>
                                                    <RowDefinition Height="*"/>
                                                </Grid.RowDefinitions>

                                                <Label Grid.Row="0" Height="30" VerticalAlignment="Center" FontSize="12" FontWeight="Bold"
                                                        HorizontalAlignment="Center" Content="Help"/>

                                                <Button Grid.Row="0" Style="{StaticResource MaterialDesignIconButton}" Click="Close_Click" ToolTip="Close" Background="Transparent"
                                                        HorizontalAlignment="Right" IsEnabled="{Binding DataContext.ControlsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}">
                                                    <materialDesign:PackIcon Kind="Close" Width="20" Height="20" VerticalAlignment="Center" Foreground="Gray" />
                                                </Button>

                                                <materialDesign:ColorZone Grid.Row="1" CornerRadius="15" Width="220" VerticalAlignment="Center" HorizontalAlignment="Center" HorizontalContentAlignment="Left"
                                                        Mode="Light" materialDesign:ShadowAssist.ShadowDepth="Depth1" Height="30" Background="WhiteSmoke" >
                                                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Right" Orientation="Horizontal">
                                                        <Button Style="{DynamicResource MaterialDesignToolButton}" VerticalContentAlignment="Top" >
                                                            <materialDesign:PackIcon Kind="Search" Width="20" Height="20" Opacity=".56" />
                                                        </Button>
                                                        <TextBox FontSize="10" FontWeight="Medium" Margin="8 0 0 0" materialDesign:HintAssist.Hint="" materialDesign:TextFieldAssist.DecorationVisibility="Hidden"
                                                            Text="Search Help" BorderThickness="0" MinWidth="180" Name="SearchBox" TextChanged="HelpSearchBox_TextChanged" VerticalAlignment="Center" />
                                                    </StackPanel>
                                                </materialDesign:ColorZone>

                                                <DataGrid Grid.Row="2" Width="300" x:Name="DGHelp" Height="Auto" Background="Transparent" HeadersVisibility="Column"
                                                      ItemsSource="{Binding HelpList}" AutoGenerateColumns="False" Margin="10 10 10 10" Focusable="False" GridLinesVisibility="None"
                                                      CanUserAddRows="False" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Auto" Cursor="Hand">
                                                    <DataGrid.CellStyle>
                                                        <Style TargetType="DataGridCell">
                                                            <Setter Property="Height" Value="35"/>
                                                        </Style>
                                                    </DataGrid.CellStyle>
                                                    <DataGrid.Columns>
                                                        <DataGridTemplateColumn Header="Popular Help Resources">
                                                            <DataGridTemplateColumn.HeaderStyle>
                                                                <Style TargetType="DataGridColumnHeader">
                                                                    <Setter Property="Height" Value="40" />
                                                                    <Setter Property="Width" Value="230" />
                                                                    <Setter Property="FontSize" Value="10" />
                                                                    <Setter Property="FontWeight" Value="DemiBold" />
                                                                    <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                                                    <Setter Property="HorizontalAlignment" Value="Left"/>
                                                                    <Setter Property="Background" Value="Transparent"/>
                                                                </Style>
                                                            </DataGridTemplateColumn.HeaderStyle>
                                                            <DataGridTemplateColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                                                        <Grid Grid.Row="0" Grid.Column="0" Margin="5 0 10 0">
                                                                            <Button Style="{StaticResource MaterialDesignIconButton}" Background="#E9F1F8" Height="25" Width="25" FocusVisualStyle="{x:Null}" Focusable="False">
                                                                                <materialDesign:PackIcon Kind="Receipt" Foreground="#247BC0" Height="15" Width="15" HorizontalAlignment="Left" Background="#E9F1F8" />
                                                                            </Button>
                                                                        </Grid>
                                                                        <Grid Grid.Row="0" Grid.Column="1">
                                                                            <TextBlock Text="{Binding Path=Help}" TextAlignment="Left" VerticalAlignment="Center" FontSize="10" TextWrapping="Wrap"
                                                                                      MaxWidth="180" FontWeight="Medium"></TextBlock>
                                                                        </Grid>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </DataGridTemplateColumn.CellTemplate>
                                                        </DataGridTemplateColumn>
                                                    </DataGrid.Columns>
                                                </DataGrid>

                                                <Button Style="{StaticResource FBButtonStyle}" Grid.Row="3" Click="Browse_Click" Background="Transparent"
                                                        HorizontalAlignment="Center" Width="200" BorderThickness="0" Margin="5" Cursor="Hand">
                                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                        <Label Content="Browse all articles" Foreground="#247BC0" FontSize="10" ></Label>
                                                        <materialDesign:PackIcon Kind="ArrowRightBoldBoxOutline" VerticalAlignment="Center" Foreground="#247BC0" />
                                                    </StackPanel>
                                                </Button>
                                            </Grid>
                                        </StackPanel>
                                    </Border>
                                </Popup>

                                <!--<Viewbox Stretch="Uniform">-->
                                <Button x:Name="btnAddOns" Style="{StaticResource MaterialDesignIconButton}" Background="Transparent"
                                      IsEnabled="{Binding DataContext.ControlsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}">
                                    <Button.Triggers>
                                        <EventTrigger RoutedEvent="Button.Click">
                                            <EventTrigger.Actions>
                                                <BeginStoryboard Name="sbBtnAddOns">
                                                    <Storyboard>
                                                        <BooleanAnimationUsingKeyFrames Storyboard.TargetName="AddOnsPopup" 
                                                             Storyboard.TargetProperty="IsOpen">
                                                            <DiscreteBooleanKeyFrame KeyTime="0:0:0" Value="True" />
                                                        </BooleanAnimationUsingKeyFrames>
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </EventTrigger.Actions>
                                        </EventTrigger>
                                        <EventTrigger RoutedEvent="Page.Unloaded" >
                                            <EventTrigger.Actions>
                                                <RemoveStoryboard BeginStoryboardName="sbBtnAddOns" />
                                            </EventTrigger.Actions>
                                        </EventTrigger>
                                    </Button.Triggers>
                                    <materialDesign:PackIcon Kind="DotsVertical" VerticalAlignment="Center" Foreground="Gray" />
                                </Button>
                                <!--</Viewbox>-->

                                <Popup x:Name="AddOnsPopup" PlacementTarget="{Binding ElementName=btnAddOns}" StaysOpen="False" AllowsTransparency="True" PopupAnimation="Fade">
                                    <Border Height="140" BorderThickness="1" BorderBrush="LightGray"
                                        Background="White" Width="130" Name="AddOns" CornerRadius="5,5,5,5">
                                        <Grid VerticalAlignment="Top">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="*" />
                                            </Grid.RowDefinitions>
                                            <ListView Name="Lv" Grid.Row="0" ScrollViewer.VerticalScrollBarVisibility="Hidden" Margin="4 2 4 2" Cursor="Hand">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Style.Triggers>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="Background" Value="Transparent" />
                                                                <Setter Property="BorderBrush" Value="SlateGray" />
                                                                <Setter Property="BorderThickness" Value="1" />
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListViewItem Height="33">
                                                    <Label Content="Invite Friends" Margin="0 3 0 0" Height="28" Style="{StaticResource mouseOverStyle}" FontSize="10" />
                                                </ListViewItem>
                                                <ListViewItem Height="33">
                                                    <Label Content="Print Page" Margin="0 3 0 0" Height="28" Style="{StaticResource mouseOverStyle}" FontSize="10" />
                                                </ListViewItem>
                                                <ListViewItem Height="33">
                                                    <Label Content="Report a Bug" Margin="0 3 0 0" Height="28" Style="{StaticResource mouseOverStyle}" FontSize="10" />
                                                </ListViewItem>
                                                <ListViewItem Height="33">
                                                    <Label Content="Files" Margin="0 3 0 0" Height="28" Style="{StaticResource mouseOverStyle}" FontSize="10" />
                                                </ListViewItem>
                                            </ListView>
                                        </Grid>
                                    </Border>
                                </Popup>

                                <!--<Viewbox Stretch="Uniform">-->
                                <Button x:Name="btnAccount" Grid.Row="0" Grid.Column="4" Style="{StaticResource MaterialDesignIconButton}"
                                      ToolTip="Account" Background="Transparent"
                                      IsEnabled="{Binding DataContext.ControlsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}">
                                    <Button.Triggers>
                                        <EventTrigger RoutedEvent="Button.Click">
                                            <EventTrigger.Actions>
                                                <BeginStoryboard Name="sbBtnAccount">
                                                    <Storyboard>
                                                        <BooleanAnimationUsingKeyFrames Storyboard.TargetName="ProfilePopup" 
                                                             Storyboard.TargetProperty="IsOpen">
                                                            <DiscreteBooleanKeyFrame KeyTime="0:0:0" Value="True" />
                                                        </BooleanAnimationUsingKeyFrames>
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </EventTrigger.Actions>
                                        </EventTrigger>
                                        <EventTrigger RoutedEvent="Page.Unloaded" >
                                            <EventTrigger.Actions>
                                                <RemoveStoryboard BeginStoryboardName="sbBtnAccount" />
                                            </EventTrigger.Actions>
                                        </EventTrigger>
                                    </Button.Triggers>
                                    <materialDesign:PackIcon Kind="AccountCircle" Foreground="#247BC0" />
                                </Button>
                                <!--</Viewbox>-->
                                <Popup x:Name="ProfilePopup" PlacementTarget="{Binding ElementName=btnAccount}" StaysOpen="False" AllowsTransparency="True" PopupAnimation="Fade">
                                    <Border Height="220" BorderThickness="1" CornerRadius="5,5,5,5" BorderBrush="LightGray" 
                                        Background="White" Width="180" Name="Profile">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="2*"/>
                                                <RowDefinition Height="4*"/>
                                            </Grid.RowDefinitions>
                                            <Ellipse Grid.Row="0" Height="40" Width="40" HorizontalAlignment="Left" Margin="10 0 10 0" >
                                                <Ellipse.Fill>
                                                    <ImageBrush ImageSource="/Images/Logo.png"/>
                                                </Ellipse.Fill>
                                            </Ellipse>
                                            <Label Grid.Row="0" x:Name="lblUser" Content="Daria Duke" HorizontalAlignment="Left" Margin="70 20 0 0" FontSize="14" FontWeight="Bold" VerticalAlignment="Top" />
                                            <Label Grid.Row="0" x:Name="lblemail" Content="dduke@sabc.on.ca" HorizontalAlignment="Left" Margin="70 45 0 0" FontSize="10" Foreground="Black" VerticalAlignment="Top" />
                                            <ListView Grid.Row="1" HorizontalAlignment="Left" VerticalAlignment="Top" Height="140" Width="170" Margin="4 0 4 0" Cursor="Hand">
                                                <!--<ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Style.Triggers>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="Background" Value="Transparent" />
                                                                <Setter Property="BorderBrush" Value="SlateGray" />
                                                                <Setter Property="BorderThickness" Value="1" />
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </ListView.ItemContainerStyle>-->

                                                <!--// Listview items style template //-->
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Style.Triggers>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="Background" Value="Transparent" />
                                                                <Setter Property="BorderBrush" Value="SlateGray" />
                                                                <Setter Property="BorderThickness" Value="1" />
                                                            </Trigger>
                                                        </Style.Triggers>
                                                        <EventSetter Event="PreviewMouseLeftButtonDown" Handler="ListViewItem_PreviewMouseLeftDown" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListViewItem Tag="Profile" Height="33">
                                                    <StackPanel Orientation="Horizontal">
                                                        <materialDesign:PackIcon Width="20" Height="20" Kind="Account" Style="{StaticResource mouseOverIcon}" />
                                                        <Label Content="My Profile" HorizontalAlignment="Center" FontSize="10" Style="{StaticResource mouseOverStyle}" Margin="15 0 0 0" VerticalAlignment="Top" />
                                                    </StackPanel>
                                                </ListViewItem>
                                                <ListViewItem Tag="Settings" Height="33">
                                                    <StackPanel Orientation="Horizontal">
                                                        <materialDesign:PackIcon Width="20" Height="20" Kind="SettingsOutline" Style="{StaticResource mouseOverIcon}" />
                                                        <Label Content="Settings" HorizontalAlignment="Center" FontSize="10" Style="{StaticResource mouseOverStyle}" Margin="15 0 0 0" VerticalAlignment="Top" />
                                                    </StackPanel>
                                                </ListViewItem>
                                                <ListViewItem Tag="Docs" Height="33">
                                                    <StackPanel Orientation="Horizontal">
                                                        <materialDesign:PackIcon Width="20" Height="20" Kind="FileDocumentBoxesOutline" Style="{StaticResource mouseOverIcon}" />
                                                        <Label Content="Documents &amp; Manuals" HorizontalAlignment="Center" FontSize="10" Style="{StaticResource mouseOverStyle}" Margin="15 0 0 0" VerticalAlignment="Top" />
                                                    </StackPanel>
                                                </ListViewItem>
                                                <ListViewItem Tag="Logout" Height="33">
                                                    <StackPanel Orientation="Horizontal">
                                                        <materialDesign:PackIcon Width="20" Height="20" Kind="Logout" Style="{StaticResource mouseOverIcon}" />
                                                        <Label Content="Log out" HorizontalAlignment="Center" FontSize="10" Style="{StaticResource mouseOverStyle}" Margin="15 0 0 0" VerticalAlignment="Top" />
                                                    </StackPanel>
                                                </ListViewItem>
                                            </ListView>
                                        </Grid>
                                    </Border>
                                </Popup>
                            </StackPanel>
                        </Viewbox>
                    </StackPanel>
                </Grid>

                <!--</StackPanel>-->
                <!--</Viewbox>-->

                <!--#endregion header-->

                <WrapPanel Grid.Row="1" Grid.ColumnSpan="3"
                      Width="{Binding ElementName=RootControl, Path=ActualWidth}"
                      Grid.RowSpan="3" Margin="0,10,-10,0" Grid.Column="1" x:Name="Wrapper"
                      Height="{Binding ElementName=RootControl, Path=ActualHeight}" >
                    <!--<Grid >
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition  Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition/>
                    </Grid.RowDefinitions>
                    -->
                    <!--#region navpnl treeview-->
                    <Border BorderBrush="Transparent" CornerRadius="10">
                        <Border.Background>
                            <SolidColorBrush x:Name="animatedPanelColor" Color="{Binding Source={x:Static settings:Settings.Default}, Path=Subsection_BG, Mode=TwoWay }"  />
                        </Border.Background>
                        <Grid x:Name="subsection_pnl" HorizontalAlignment="Center" Grid.Row="0" Grid.Column="1" VerticalAlignment="Top">
                            <DockPanel>
                                <Grid DockPanel.Dock="Top">
                                    <TreeView x:Name="subsection_tv" Height="Auto" Margin="5,10,5,10" VerticalAlignment="Center" ScrollViewer.CanContentScroll="False" 
                                           ScrollViewer.HorizontalScrollBarVisibility="Hidden" HorizontalAlignment="Left" Width="350" 
                                           ItemContainerStyle="{DynamicResource TopTreeViewItemStyle}" Foreground="Black" FontWeight="Bold" >
                                        <TreeView.ItemTemplate>
                                            <HierarchicalDataTemplate >
                                            </HierarchicalDataTemplate>
                                        </TreeView.ItemTemplate>
                                    </TreeView>
                                </Grid>

                                <StackPanel VerticalAlignment="Bottom" DockPanel.Dock="Bottom">
                                    <Button x:Name="subsection_flyinbtn" Visibility="Visible" FontSize="15" FontWeight="Bold" HorizontalAlignment="right" VerticalAlignment="Top" Style="{StaticResource MaterialDesignFloatingActionMiniAccentButton}" Background="{x:Null}" BorderBrush="{x:Null}" Foreground="Black" Click="subsection_flyinbtn_Click" >
                                        <materialDesign:PackIcon Kind="ChevronLeft" Width="30" Height="30"/>
                                    </Button>
                                </StackPanel>
                                <StackPanel VerticalAlignment="Bottom" DockPanel.Dock="Bottom">
                                    <Button x:Name="subsection_flyoutbtn" Visibility="Hidden" FontSize="15" FontWeight="Bold" HorizontalAlignment="Left" Margin="-10 0 0 0" VerticalAlignment="Top" Style="{StaticResource MaterialDesignFloatingActionMiniAccentButton}" Background="{x:Null}" BorderBrush="{x:Null}" Foreground="Black" Click="subsection_flyoutbtn_Click">
                                        <materialDesign:PackIcon Kind="ChevronRight" Width="30" Height="30"/>
                                    </Button>
                                </StackPanel>
                            </DockPanel>
                        </Grid>
                    </Border>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Frame x:Name="MainWindowFrame" NavigationUIVisibility="Hidden" Grid.Row="0" Grid.RowSpan="2"/>
                        <DockPanel LastChildFill="False" Grid.Row="1">
                            <Button x:Name="feedbackBtn" DockPanel.Dock="Right" Visibility="Visible" Click="feedbackBtnClicked" Background="{Binding Source={x:Static settings:Settings.Default}, Path=MainPalette_Blue, Mode=TwoWay }" 
                                Foreground="White" Width="45" Height="45" Margin="15,5,45,35" Style="{StaticResource MaterialDesignFloatingActionButton}" >
                                <Viewbox Width="32" Height="32">
                                    <materialDesign:PackIcon Kind="BugOutline" Foreground="White" Height="35" Width="35" ToolTip="Close" />
                                    <!--<Canvas Height="23" Width="22">
                                        <Path Fill="White" Data="M12 3C6.5 3 2 6.58 2 11C2.05 13.15 3.06 15.17 4.75 16.5C4.75 17.1 4.33 18.67 2 21C4.37 20.89 6.64 20 8.47 18.5C9.61 18.83 10.81 19 12 19C17.5 19 22 15.42 22 11S17.5 3 12 3M12 17C7.58 17 4 14.31 4 11S7.58 5 12 5 20 7.69 20 11 16.42 17 12 17M17 12V10H15V12H17M13 12V10H11V12H13M9 12V10H7V12H9Z" />
                                    </Canvas>-->
                                </Viewbox>
                            </Button>
                        </DockPanel>
                    </Grid>
                </WrapPanel>


                <!--#region side menu bar-->
                <Grid x:Name="tab_pnl" Grid.RowSpan="3" Grid.Row="1"
                    Grid.ColumnSpan="2" Grid.Column="0" Margin="0 10 0 0"
                    HorizontalAlignment="left" Width="60"
                    Background="{Binding Source={x:Static settings:Settings.Default}, Path=MainPalette_Blue, Mode=TwoWay }" >
                    <StackPanel Margin="0 10 0 0" >
                        <ListView x:Name="LV" Background="Transparent" BorderBrush="Transparent"
                               ScrollViewer.HorizontalScrollBarVisibility="Disabled" HorizontalContentAlignment="Left">
                            <!--// Analytics //-->
                            <ListViewItem Tag="Analytics" Margin="0 5 0 5" x:Name="AnalyticsLVItem">
                                <StackPanel Orientation="Horizontal" Width="240">
                                    <materialDesign:PackIcon Kind="ChartLine" Foreground="White" Height="30" Width="30" Margin="5 0 0 0"/>
                                    <TextBlock Text="Analytics" FontSize="18"
                                           Margin="15,0,5,0" Style="{StaticResource font_style}"/>
                                </StackPanel>
                            </ListViewItem>

                            <!--// Planner //-->
                            <ListViewItem Tag="Planner" Margin="0 5 0 5" x:Name="PlannerLVItem">
                                <StackPanel Orientation="Horizontal" Width="240">
                                    <materialDesign:PackIcon Kind="Diary" Foreground="White" Height="30" Width="30" Margin="5 0 0 0" />
                                    <TextBlock Text="Planner" FontSize="18"
                                           Margin="15,0,5,0" Style="{StaticResource font_style}"/>
                                </StackPanel>
                            </ListViewItem>

                            <!--// Machine Learning //-->
                            <!--
                            <ListViewItem Tag="Machinelearning" Margin="0 5 0 5" x:Name="MLLVItem">
                                <StackPanel Orientation="Horizontal" Width="240">
                                    <materialDesign:PackIcon Kind="BulbOnOutline" Foreground="White" Height="30" Width="30" Margin="5 0 0 0" />
                                    <TextBlock Text="Machine Learning" FontSize="18" Margin="15,0,5,0"
                                           Style="{StaticResource font_style}"/>
                                </StackPanel>
                            </ListViewItem>-->

                            <!--// Resource Management //-->
                            <ListViewItem Tag="ResourceManagement" Margin="0 5 0 5" x:Name="RMLVItem">
                                <StackPanel Orientation="Horizontal" Width="240">
                                    <materialDesign:PackIcon Kind="KeyChainVariant" Foreground="White" Height="30" Width="30" Margin="5 0 0 0"/>
                                    <TextBlock Text="Resources" FontSize="18"
                                           Margin="15,0,5,0" Style="{StaticResource font_style}"/>
                                </StackPanel>
                            </ListViewItem>

                            <!--// Reports //-->
                            <!--
                            <ListViewItem Tag="Report" Margin="0 5 0 5" >
                                <StackPanel Orientation="Horizontal" Width="240">
                                    <materialDesign:PackIcon Kind="Report" Foreground="White" Height="30" Width="30" Margin="5 0 0 0"/>
                                    <TextBlock Text="Reports" FontSize="18"
                                           Margin="15,0,5,0" Style="{StaticResource font_style}"/>
                                </StackPanel>
                            </ListViewItem>-->

                            <!--// Settings //-->
                            <ListViewItem Tag="Settings" x:Name="SettingsListViewItem" Margin="5 320 0 0" >
                                <StackPanel Orientation="Horizontal" Width="240">
                                    <materialDesign:PackIcon Kind="Gear" Width="30" Height="28" Foreground="White" />
                                    <TextBlock Text="Administrator" FontSize="18"
                                           Margin="15,0,5,0" Style="{StaticResource font_style}"/>
                                </StackPanel>
                            </ListViewItem>

                            <!--// Listview items style template //-->
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="{x:Type ListViewItem}">
                                                <Border x:Name="Bd"
                                                    Margin="0 0 5 10"
                                                    Height="35"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                    Background="{TemplateBinding Background}"
                                                    Padding="{TemplateBinding Padding}"
                                                    SnapsToDevicePixels="True" CornerRadius="10">
                                                    <Border.Style>
                                                        <Style>
                                                        </Style>
                                                    </Border.Style>
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                                  Grid.Column="0"
                                                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                                                    </Grid>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <MultiTrigger>
                                                        <MultiTrigger.Conditions>
                                                            <Condition Property="IsMouseOver" Value="True"/>
                                                        </MultiTrigger.Conditions>
                                                        <Setter Property="Background" TargetName="Bd" Value="#37465273"/>
                                                        <Setter Property="Height" TargetName="Bd" Value="35"/>
                                                        <Setter Property="BorderBrush" TargetName="Bd" Value="#37465273"/>
                                                        <Setter Property="Width" TargetName="Bd" Value="240"/>
                                                        <Setter Property="Margin" TargetName="Bd" Value="0 0 10 10"/>
                                                        <Setter Property="CornerRadius" TargetName="Bd" Value="20" />
                                                    </MultiTrigger>

                                                    <MultiTrigger>
                                                        <MultiTrigger.Conditions>
                                                            <Condition Property="IsSelected" Value="True"/>
                                                        </MultiTrigger.Conditions>
                                                        <Setter Property="CornerRadius" TargetName="Bd" Value="15" />
                                                        <Setter Property="Background" Value="#025999"/>
                                                        <Setter Property="Foreground" Value="WhiteSmoke"/>
                                                    </MultiTrigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <EventSetter Event="PreviewMouseLeftButtonDown" Handler="ListViewItem_PreviewMouseLeftButtonDown" />
                                </Style>
                            </ListView.ItemContainerStyle>
                        </ListView>
                    </StackPanel>
                </Grid>
                <!--#endregion side menu bar-->
            </Grid>
        </Border>
    </Grid>
</Window>
